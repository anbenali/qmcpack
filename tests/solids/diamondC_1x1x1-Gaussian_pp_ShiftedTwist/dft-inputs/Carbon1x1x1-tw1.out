Discarded 56 diffused primitive functions, 0 contracted functions
#INFO: **** input file is /home/benali/Applications/Phase/Non_Gamma/Carbon.py ****
#!/usr/bin/env python
import numpy
import h5py
from pyscf.pbc import gto, scf, dft
from mpi4pyscf.pbc import df as mpidf

cell = gto.Cell()
cell.a             = '''
                    2.0 0 0  
                    0 2.0 0  
                    0 0 2.0 
                     '''
cell.dimension     = 3
cell.basis         = 'bfd-vdz'
cell.ecp           = 'bfd'
cell.unit          = 'B'
cell.a = numpy.eye(3)*3.5668
cell.atom = '''C     0.      0.      0.    
              C     0.8917  0.8917  0.8917
              C     1.7834  1.7834  0.    
              C     2.6751  2.6751  0.8917
              C     1.7834  0.      1.7834
              C     2.6751  0.8917  2.6751
              C     0.      1.7834  1.7834
              C     0.8917  2.6751  2.6751'''
cell.drop_exponent = 0.15
cell.verbose       = 5
cell.charge        = 0
cell.spin          = 0
cell.build()

sp_twist=[0.333,0.333,0.333]
twist = numpy.asarray([0.333,0.333,0.333]) / 1.0
kmesh=[1,1,1]
kpts = cell.make_kpts((1,1,1), with_gamma_point=False,  wrap_around=True, scaled_center=twist)

mf = scf.KRHF(cell,kpts)
mf.with_df = mpidf.FFTDF(cell,kpts)
#mf.with_df_cderi_to_save = 'df_ints.h5'   # new
#mf.with_df.build()
#mf.xc = 'pbe,pbe'

mf.with_df._cderi = 'df_ints.h5'
mf.exxdiv = 'ewald'


mf.chkfile = "tw1_ds30.dump"                         # store checkpoint file in scf.dump
#dm = mf.from_chk('tw1_ds30.dump')
#mf = scf.addons.smearing2_(mf, sigma=.0001, method='fermi', dS=30)
mf.max_cycle = 200




e_scf=mf.kernel()

ener = open('e_scf','w')
ener.write('%s\n' % (e_scf))
print('e_scf',e_scf)
ener.close()

title="S1-twist1"
from PyscfToQmcpack import savetoqmcpack
savetoqmcpack(cell,mf,title=title,kmesh=kmesh,kpts=kpts,sp_twist=sp_twist)

#INFO: ******************** input file end ********************


System: ('Linux', 'node001', '3.10.0-957.1.3.el7.x86_64', '#1 SMP Thu Nov 29 14:49:43 UTC 2018', 'x86_64', 'x86_64')  Threads 40
Python 2.7.5 (default, Oct 30 2018, 23:45:53) 
[GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]
numpy 1.15.4  scipy 0.12.1
Date: Tue Jun 18 10:31:54 2019
PySCF version 1.6.1
PySCF path  /home/benali/src/pyscf/pyscf
GIT ORIG_HEAD e57b4cb2ebe022963d3970e7b2d99c49b0541e6f
GIT HEAD      ref: refs/heads/master
GIT master branch  dbfd3e3ef7fa23ad950d8c795ad6d6b4dbcf2eaa

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 8
[INPUT] num. electrons = 32
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = B
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 C      0.471867318977   0.471867318977   0.471867318977 AA    0.891700000000   0.891700000000   0.891700000000 Bohr
[INPUT]  3 C      0.943734637955   0.943734637955   0.000000000000 AA    1.783400000000   1.783400000000   0.000000000000 Bohr
[INPUT]  4 C      1.415601956932   1.415601956932   0.471867318977 AA    2.675100000000   2.675100000000   0.891700000000 Bohr
[INPUT]  5 C      0.943734637955   0.000000000000   0.943734637955 AA    1.783400000000   0.000000000000   1.783400000000 Bohr
[INPUT]  6 C      1.415601956932   0.471867318977   1.415601956932 AA    2.675100000000   0.891700000000   2.675100000000 Bohr
[INPUT]  7 C      0.000000000000   0.943734637955   0.943734637955 AA    0.000000000000   1.783400000000   1.783400000000 Bohr
[INPUT]  8 C      0.471867318977   1.415601956932   1.415601956932 AA    0.891700000000   2.675100000000   2.675100000000 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] C
[INPUT] 0    0    [7    /1   ]  13.073594         -0.000705
                                6.541187          0.015176
                                3.272791          -0.121499
                                1.637494          -0.033512
                                0.819297          0.180113
                                0.409924          0.380369
                                0.2051            0.397529
[INPUT] 1    0    [6    /1   ]  7.480076          0.021931
                                3.741035          0.054425
                                1.871016          0.112024
                                0.935757          0.210979
                                0.468003          0.289868
                                0.234064          0.302667
[INPUT] 2    0    [1    /1   ]  0.561161             1

Ewald components = 6.19374189930159e-06, -187.525106130014, 90.8684119175782
nuclear repulsion = -96.6566880186942
number of shells = 24
number of NR pGTOs = 240
number of NR cGTOs = 72
basis = bfd-vdz
ecp = bfd
CPU time:         0.54
lattice vectors  a1 [3.566800000, 0.000000000, 0.000000000]
                 a2 [0.000000000, 3.566800000, 0.000000000]
                 a3 [0.000000000, 0.000000000, 3.566800000]
dimension = 3
low_dim_ft_type = None
Cell volume = 45.3771
exp_to_discard = 0.15
rcut = 14.27373091585211 (nimgs = [5 5 5])
lattice sum = 667 cells
precision = 1e-08
pseudo = None
ke_cutoff = 366.8014593069121
    = [31 31 31] mesh (29791 PWs)
ew_eta = 2.51938
ew_cut = 2.7669751059219294 (nimgs = [1 1 1])


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF-KSCF-RHF-SCF-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-07
SCF gradient tol = None
max. SCF cycles = 200
direct_scf = False
chkfile to save SCF result = tw1_ds30.dump
max_memory 4000 MB (current use 115 MB)


******** PBC SCF flags ********
N kpts = 1
kpts = [[0.58660444 0.58660444 0.58660444]]
Exchange divergence treatment (exxdiv) = ewald
Ewald components = 4.47178546364969e-37, -1.4268636568447, 1.02912654241709
    madelung (= occupied orbital energy shift) = 0.7954742288552237
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -12.7275876617
DF object = <mpi4pyscf.pbc.df.fft.FFTDF object at 0x7faf60f41890>


******** <class 'mpi4pyscf.pbc.df.fft.FFTDF'> ********
mesh = [31 31 31] (29791 PWs)
len(kpts) = 1
Set gradient conv threshold to 0.000316228
Big error detected in the electron number of initial guess density matrix (Ne/cell = 26.4129)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 32.0
cond(S) = [118060.37090063]
Ewald components = 4.47178546364969e-37, -1.4268636568447, 1.02912654241709
    CPU time for vj and vk    288.85 sec, wall time      9.31 sec
E1 = (78.5074598343113+2.3103952169188436e-14j)  E_coul = (-53.71210066159901+1.6610003121266378e-15j)
Ewald components = 6.19374189930159e-06, -187.525106130014, 90.8684119175782
init E= -71.8613288459819
    CPU time for initialize scf   2524.58 sec, wall time     65.93 sec
HOMO = 3.10620654632  LUMO = 4.07550804544
     k-point                  mo_energy
   0 ( 0.333  0.333  0.333)   [-3.47374974 -0.38403683 -0.38403683 -0.38403682  1.45589231  1.45589231
  1.45589232  2.06590022  2.56346649  2.56346649  2.5634665   2.64644848
  2.64644849  2.64644849  3.10620655  3.10620655] [ 4.07550805  4.07550805  4.07550805  4.39765967  4.39765967  4.87117087
  4.87117088  4.87117088  5.30558651  5.30558651  5.30558655  5.50397066
  5.67570738  6.02836214  6.02836214  6.10408889  6.10408889  6.10408889
  6.39177774  6.39177774  6.39177775  6.96032712  6.96032715  6.96032715
  7.38095985  7.38095985  7.38095988  7.64824285  7.64824285  7.64824285
  8.43730193  8.43730193  8.43730204  8.64618048  8.64618048  8.90913181
 10.49737207 10.49737207 11.23374815 11.23374857 11.23374857 11.31809008
 11.31809008 11.31809023 12.18076498 12.18076551 12.18076551 12.53571653
 12.53571653 12.60266168 13.57725331 13.57725331 13.57725336 14.96296576
 14.96296582 14.96296582]
Ewald components = 4.47178546364969e-37, -1.4268636568447, 1.02912654241709
    CPU time for vj and vk     96.77 sec, wall time      3.44 sec
E1 = (95.54900624779471+8.995582057025331e-14j)  E_coul = (-21.874997849628+4.593547764386585e-15j)
Ewald components = 6.19374189930159e-06, -187.525106130014, 90.8684119175782
cycle= 1 E= -22.9826796205274  delta_E= 48.9  |g|= 1.07  |ddm|= 22.4
    CPU time for cycle= 1     96.78 sec, wall time      3.46 sec
HOMO = 2.49248210903  LUMO = 4.17326288382
     k-point                  mo_energy
   0 ( 0.333  0.333  0.333)   [0.38005271 0.52540526 0.52540526 0.52540527 1.43774309 1.4377431
 1.4377431  1.70400544 2.10820966 2.10820967 2.10820967 2.19227083
 2.19227083 2.19227083 2.49248211 2.49248211] [ 4.17326288  4.17326288  4.17326289  4.46138638  4.46138638  4.8836967
  4.88369671  4.88369671  5.36161867  5.36161867  5.36161871  5.59848196
  5.7320903   6.0146816   6.0146816   6.14601166  6.14601166  6.14601166
  6.40318146  6.40318146  6.40318146  6.98770822  6.98770825  6.98770825
  7.49033712  7.49033712  7.49033715  7.62620014  7.62620014  7.62620014
  8.60274124  8.60274124  8.60274135  8.64740832  8.64740832  9.0714809
 10.54300726 10.54300726 11.28699857 11.28699899 11.28699899 11.39324518
 11.39324518 11.39324532 12.29553364 12.29553417 12.29553417 12.63780796
 12.63780796 12.90470165 13.79759726 13.79759726 13.79759729 15.20012908
 15.20012915 15.20012915]
Ewald components = 4.47178546364969e-37, -1.4268636568447, 1.02912654241709
    CPU time for vj and vk     99.02 sec, wall time      3.34 sec
E1 = (95.49349345241224+8.609779555968089e-14j)  E_coul = (-21.90948764800854+6.7307270867900115e-15j)
Ewald components = 6.19374189930159e-06, -187.525106130014, 90.8684119175782
cycle= 2 E= -23.0726822142905  delta_E= -0.09  |g|= 0.131  |ddm|= 4.39
    CPU time for cycle= 2     99.03 sec, wall time      3.36 sec
HOMO = 2.48791509277  LUMO = 4.17504851866
     k-point                  mo_energy
   0 ( 0.333  0.333  0.333)   [0.38432583 0.52354848 0.52354848 0.52354848 1.43876388 1.43876389
 1.43876389 1.7011979  2.10436752 2.10436754 2.10436754 2.19007171
 2.19007171 2.19007171 2.48791509 2.48791509] [ 4.17504852  4.17504852  4.17504852  4.45997974  4.45997974  4.88244937
  4.88244938  4.88244938  5.36219723  5.36219723  5.36219727  5.59691218
  5.73496171  6.01459744  6.01459744  6.1452276   6.1452276   6.1452276
  6.40556299  6.40556299  6.40556299  6.98622882  6.98622885  6.98622885
  7.48640547  7.48640547  7.4864055   7.62444121  7.62444121  7.62444121
  8.59408506  8.59408506  8.59408517  8.64560877  8.64560877  9.06704569
 10.53889709 10.53889709 11.28182677 11.28182718 11.28182718 11.38713754
 11.38713754 11.38713768 12.28752211 12.28752264 12.28752264 12.63052107
 12.63052107 12.89637282 13.7887966  13.7887966  13.78879664 15.18891014
 15.1889102  15.1889102 ]
Ewald components = 4.47178546364969e-37, -1.4268636568447, 1.02912654241709
    CPU time for vj and vk     96.32 sec, wall time      3.24 sec
E1 = (95.48579903508306+8.579248422790897e-14j)  E_coul = (-21.90447921016435+6.314393452555578e-15j)
Ewald components = 6.19374189930159e-06, -187.525106130014, 90.8684119175782
cycle= 3 E= -23.0753681937754  delta_E= -0.00269  |g|= 0.0158  |ddm|= 0.465
    CPU time for cycle= 3     96.33 sec, wall time      3.26 sec
HOMO = 2.48899091059  LUMO = 4.1747094914
     k-point                  mo_energy
   0 ( 0.333  0.333  0.333)   [0.38502302 0.52382317 0.52382317 0.52382317 1.43905281 1.43905281
 1.43905281 1.70104301 2.10530032 2.10530033 2.10530033 2.1904462
 2.19044621 2.19044621 2.48899091 2.48899091] [ 4.17470949  4.17470949  4.17470949  4.46015033  4.46015033  4.88286541
  4.88286542  4.88286542  5.36248052  5.36248052  5.36248056  5.59673203
  5.73439829  6.01471859  6.01471859  6.14548648  6.14548648  6.14548648
  6.40583125  6.40583125  6.40583125  6.98661571  6.98661574  6.98661574
  7.48698455  7.48698455  7.48698458  7.62434175  7.62434175  7.62434175
  8.59528363  8.59528363  8.59528374  8.64566538  8.64566538  9.06795251
 10.53966662 10.53966662 11.28245216 11.28245258 11.28245258 11.38802452
 11.38802452 11.38802466 12.28868186 12.28868238 12.28868238 12.63163043
 12.63163043 12.89833995 13.79038936 13.79038936 13.79038939 15.19082394
 15.19082401 15.19082401]
Ewald components = 4.47178546364969e-37, -1.4268636568447, 1.02912654241709
    CPU time for vj and vk     96.24 sec, wall time      3.09 sec
E1 = (95.48500954709704+8.558431741079175e-14j)  E_coul = (-21.903764632838392+6.50868248186498e-15j)
Ewald components = 6.19374189930159e-06, -187.525106130014, 90.8684119175782
cycle= 4 E= -23.0754431044355  delta_E= -7.49e-05  |g|= 0.00255  |ddm|= 0.068
    CPU time for cycle= 4     96.25 sec, wall time      3.11 sec
HOMO = 2.4889011672  LUMO = 4.17472299705
     k-point                  mo_energy
   0 ( 0.333  0.333  0.333)   [0.38498149 0.52377286 0.52377286 0.52377286 1.43898426 1.43898427
 1.43898427 1.7009577  2.1052133  2.10521332 2.10521332 2.19031805
 2.19031805 2.19031805 2.48890117 2.48890117] [ 4.174723    4.174723    4.174723    4.46009135  4.46009135  4.88288592
  4.88288593  4.88288593  5.36245971  5.36245971  5.36245975  5.59663816
  5.73441185  6.01475014  6.01475014  6.14545754  6.14545754  6.14545754
  6.4058474   6.4058474   6.40584741  6.98659309  6.98659312  6.98659312
  7.48685783  7.48685783  7.48685786  7.62425554  7.62425554  7.62425554
  8.59506431  8.59506431  8.59506442  8.64564533  8.64564533  9.06778033
 10.53958364 10.53958364 11.28232548 11.2823259  11.2823259  11.38789615
 11.38789615 11.38789629 12.28850203 12.28850255 12.28850255 12.63143414
 12.63143414 12.89800009 13.7901094  13.7901094  13.79010943 15.19050112
 15.19050119 15.19050119]
Ewald components = 4.47178546364969e-37, -1.4268636568447, 1.02912654241709
    CPU time for vj and vk     94.41 sec, wall time      3.22 sec
E1 = (95.48508297751695+8.45712389008213e-14j)  E_coul = (-21.90384028565895+9.492406860545088e-15j)
Ewald components = 6.19374189930159e-06, -187.525106130014, 90.8684119175782
cycle= 5 E= -23.0754453268362  delta_E= -2.22e-06  |g|= 0.000534  |ddm|= 0.00973
    CPU time for cycle= 5     94.42 sec, wall time      3.24 sec
HOMO = 2.48891314  LUMO = 4.17472439991
     k-point                  mo_energy
   0 ( 0.333  0.333  0.333)   [0.38500319 0.52377887 0.52377887 0.52377888 1.43899238 1.43899239
 1.43899239 1.70095752 2.10521964 2.10521965 2.10521965 2.1903216
 2.1903216  2.1903216  2.48891314 2.48891314] [ 4.1747244   4.1747244   4.1747244   4.46008413  4.46008413  4.88290162
  4.88290163  4.88290163  5.36246859  5.36246859  5.36246863  5.59664159
  5.73440707  6.01475886  6.01475886  6.14546644  6.14546644  6.14546644
  6.40585471  6.40585471  6.40585471  6.98659883  6.98659886  6.98659886
  7.48686489  7.48686489  7.48686492  7.6242379   7.6242379   7.6242379
  8.59508075  8.59508075  8.59508086  8.64564777  8.64564777  9.06779413
 10.53959988 10.53959988 11.28233321 11.28233362 11.28233362 11.38791192
 11.38791192 11.38791207 12.28851922 12.28851974 12.28851974 12.63143936
 12.63143936 12.89803511 13.79013289 13.79013289 13.79013292 15.19053024
 15.19053031 15.19053031]
Ewald components = 4.47178546364969e-37, -1.4268636568447, 1.02912654241709
    CPU time for vj and vk     97.14 sec, wall time      3.37 sec
E1 = (95.4850788994686+8.504308368628699e-14j)  E_coul = (-21.90383631882964+4.954370247389761e-15j)
Ewald components = 6.19374189930159e-06, -187.525106130014, 90.8684119175782
cycle= 6 E= -23.0754454380552  delta_E= -1.11e-07  |g|= 4.22e-05  |ddm|= 0.0023
    CPU time for cycle= 6     97.14 sec, wall time      3.40 sec
HOMO = 2.48891193797  LUMO = 4.17472419855
     k-point                  mo_energy
   0 ( 0.333  0.333  0.333)   [0.38500179 0.5237778  0.5237778  0.5237778  1.4389906  1.43899061
 1.43899061 1.70095547 2.10521849 2.10521851 2.10521851 2.19031943
 2.19031943 2.19031943 2.48891194 2.48891194] [ 4.1747242   4.1747242   4.1747242   4.46008357  4.46008357  4.88290209
  4.8829021   4.8829021   5.36246835  5.36246835  5.36246839  5.59664012
  5.73440733  6.01475924  6.01475924  6.1454659   6.1454659   6.1454659
  6.40585535  6.40585535  6.40585536  6.98659882  6.98659884  6.98659884
  7.4868635   7.4868635   7.48686353  7.62423664  7.62423665  7.62423665
  8.59507778  8.59507778  8.5950779   8.64564735  8.64564735  9.06779166
 10.53959857 10.53959857 11.28233148 11.2823319  11.2823319  11.38791016
 11.38791016 11.3879103  12.28851691 12.28851744 12.28851744 12.63143703
 12.63143703 12.89803026 13.79012917 13.79012917 13.7901292  15.19052586
 15.19052592 15.19052592]
Ewald components = 4.47178546364969e-37, -1.4268636568447, 1.02912654241709
    CPU time for vj and vk     94.07 sec, wall time      3.16 sec
E1 = (95.48508053405642+8.411327190316342e-14j)  E_coul = (-21.90383795403776+6.536438057480609e-15j)
Ewald components = 6.19374189930159e-06, -187.525106130014, 90.8684119175782
cycle= 7 E= -23.0754454386755  delta_E= -6.2e-10  |g|= 4.83e-06  |ddm|= 0.00019
    CPU time for cycle= 7     94.09 sec, wall time      3.18 sec
HOMO = 2.488912082  LUMO = 4.17472415839
     k-point                  mo_energy
   0 ( 0.333  0.333  0.333)   [0.38500208 0.52377796 0.52377796 0.52377796 1.43899075 1.43899076
 1.43899076 1.70095552 2.10521859 2.1052186  2.1052186  2.19031954
 2.19031954 2.19031954 2.48891208 2.48891208] [ 4.17472416  4.17472416  4.17472416  4.46008355  4.46008355  4.8829022
  4.88290221  4.88290221  5.36246839  5.36246839  5.36246844  5.59664017
  5.73440724  6.0147593   6.0147593   6.14546598  6.14546598  6.14546598
  6.40585541  6.40585541  6.40585541  6.98659887  6.9865989   6.9865989
  7.48686354  7.48686354  7.48686357  7.62423655  7.62423655  7.62423655
  8.59507793  8.59507793  8.59507805  8.64564737  8.64564737  9.06779175
 10.53959866 10.53959866 11.28233156 11.28233198 11.28233198 11.38791031
 11.38791031 11.38791045 12.2885171  12.28851762 12.28851762 12.63143713
 12.63143713 12.89803061 13.7901294  13.7901294  13.79012943 15.19052615
 15.19052622 15.19052622]
Ewald components = 4.47178546364969e-37, -1.4268636568447, 1.02912654241709
    CPU time for vj and vk     99.19 sec, wall time      3.20 sec
E1 = (95.4850806529611+8.484879465697759e-14j)  E_coul = (-21.90383807295009+6.952771691715043e-15j)
Ewald components = 6.19374189930159e-06, -187.525106130014, 90.8684119175782
Extra cycle  E= -23.0754454386831  delta_E= -7.66e-12  |g|= 1.79e-06  |ddm|= 1.41e-05
    CPU time for scf_cycle   3297.82 sec, wall time     92.16 sec
    CPU time for SCF   3297.83 sec, wall time     92.17 sec
converged SCF energy = -23.0754454386831
('e_scf', -23.075445438683147)
Using Python 2.x
Wavefunction successfully saved to QMCPACK HDF5 Format
Use: "convert4qmc -pyscf  S1-twist1.h5" to generate QMCPACK input files
